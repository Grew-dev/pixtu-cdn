// Pixtu Pixel v1.0.0 | Published By Grew.dev | Created By Kimmo Ihanus | MIT License

(function(){var e,t;e=this,t=function(){var e,t,i,n,r,o,u,s,a,f,c,d,m,v,l,T;return s={},i=document,f=!1,c="active",o=6e4,r=!1,function(){return(65536*(1+Math.random())|0).toString(16).substring(1)},l={},v="__ceGUID",t={add:function(e,t,i){return e[v]=void 0,e[v]||(e[v]="ifvisible.object.event.identifier"),l[e[v]]||(l[e[v]]={}),l[e[v]][t]||(l[e[v]][t]=[]),l[e[v]][t].push(i)},remove:function(e,t,i){var n,r,o,u,s;if(i){if(e[v]&&l[e[v]]&&l[e[v]][t])for(r=o=0,u=(s=l[e[v]][t]).length;o<u;r=++o)if((n=s[r])===i)return l[e[v]][t].splice(r,1),n}else if(e[v]&&l[e[v]]&&l[e[v]][t])return delete l[e[v]][t]},fire:function(e,t,i){var n,r,o,u,s;if(e[v]&&l[e[v]]&&l[e[v]][t]){for(s=[],r=0,o=(u=l[e[v]][t]).length;r<o;r++)n=u[r],s.push(n(i||{}));return s}}},T=!1,e=function(e,t,i){return T||(T=e.addEventListener?function(e,t,i){return e.addEventListener(t,i,!1)}:e.attachEvent?function(e,t,i){return e.attachEvent("on"+t,i,!1)}:function(e,t,i){return e["on"+t]=i}),T(e,t,i)},function(e,t){var n;return i.createEventObject?e.fireEvent("on"+t,n):((n=i.createEvent("HTMLEvents")).initEvent(t,!0,!0),!e.dispatchEvent(n))},u=function(){var e,t,n,r;for(void 0,r=3,n=i.createElement("div"),e=n.getElementsByTagName("i"),t=function(){return n.innerHTML="<!--[if gt IE "+ ++r+"]><i></i><![endif]-->",e[0]};t(););return r>4?r:void 0}(),n=!1,m=void 0,void 0!==i.hidden?(n="hidden",m="visibilitychange"):void 0!==i.mozHidden?(n="mozHidden",m="mozvisibilitychange"):void 0!==i.msHidden?(n="msHidden",m="msvisibilitychange"):void 0!==i.webkitHidden&&(n="webkitHidden",m="webkitvisibilitychange"),d=function(){var t,n;return t=!1,(n=function(){return clearTimeout(t),"active"!==c&&s.wakeup(),r=+new Date,t=setTimeout(function(){if("active"===c)return s.idle()},o)})(),e(i,"mousemove",n),e(i,"keyup",n),e(i,"touchstart",n),e(window,"scroll",n),s.focus(n),s.wakeup(n)},a=function(){var t;return!!f||(!1===n?(t="blur",u<9&&(t="focusout"),e(window,t,function(){return s.blur()}),e(window,"focus",function(){return s.focus()})):e(i,m,function(){return i[n]?s.blur():s.focus()},!1),f=!0,d())},s={setIdleDuration:function(e){return o=1e3*e},getIdleDuration:function(){return o},getIdleInfo:function(){var e,t;return e=+new Date,t={},"idle"===c?(t.isIdle=!0,t.idleFor=e-r,t.timeLeft=0,t.timeLeftPer=100):(t.isIdle=!1,t.idleFor=e-r,t.timeLeft=r+o-e,t.timeLeftPer=(100-100*t.timeLeft/o).toFixed(2)),t},focus:function(e){return"function"==typeof e?this.on("focus",e):(c="active",t.fire(this,"focus"),t.fire(this,"wakeup"),t.fire(this,"statusChanged",{status:c})),this},blur:function(e){return"function"==typeof e?this.on("blur",e):(c="hidden",t.fire(this,"blur"),t.fire(this,"idle"),t.fire(this,"statusChanged",{status:c})),this},idle:function(e){return"function"==typeof e?this.on("idle",e):(c="idle",t.fire(this,"idle"),t.fire(this,"statusChanged",{status:c})),this},wakeup:function(e){return"function"==typeof e?this.on("wakeup",e):(c="active",t.fire(this,"wakeup"),t.fire(this,"statusChanged",{status:c})),this},on:function(e,i){return a(),t.add(this,e,i),this},off:function(e,i){return a(),t.remove(this,e,i),this},onEvery:function(e,t){var i,n;return a(),i=!1,t&&(n=setInterval(function(){if("active"===c&&!1===i)return t()},1e3*e)),{stop:function(){return clearInterval(n)},pause:function(){return i=!0},resume:function(){return i=!1},code:n,callback:t}},now:function(e){return a(),c===(e||"active")}}},"function"==typeof define&&define.amd?define(function(){return t()}):"object"==typeof exports?module.exports=t():e.ifvisible=t()}).call(this),TimeMe={startStopTimes:{},currentPageName:"default-page-name",startTimer:function(){var e=TimeMe.currentPageName;if(void 0===TimeMe.startStopTimes[e])TimeMe.startStopTimes[e]=[];else{var t=TimeMe.startStopTimes[e],i=t[t.length-1];if(void 0!==i&&void 0===i.stopTime)return}TimeMe.startStopTimes[e].push({startTime:new Date,stopTime:void 0})},stopTimer:function(){var e=TimeMe.currentPageName,t=TimeMe.startStopTimes[e];void 0!==t&&0!==t.length&&void 0===t[t.length-1].stopTime&&(t[t.length-1].stopTime=new Date)},getTimeOnCurrentPageInSeconds:function(){return TimeMe.getTimeOnPageInSeconds(TimeMe.currentPageName)},getTimeOnPageInSeconds:function(e){var t=TimeMe.startStopTimes[e];if(void 0!==t){for(var i=0,n=0;n<t.length;n++){var r=t[n].startTime,o=t[n].stopTime;void 0===o&&(o=new Date),i+=(o-r)/1e3}return Number(i)}},getTimeOnAllPagesInSeconds:function(){for(var e=[],t=Object.keys(TimeMe.startStopTimes),i=0;i<t.length;i++){var n=t[i],r=TimeMe.getTimeOnPageInSeconds(n);e.push({pageName:n,timeOnPage:r})}return e},setIdleDurationInSeconds:function(e){var t=parseFloat(e);if(!1!==isNaN(t))throw{name:"InvalidDurationException",message:"An invalid duration time ("+e+") was provided."};ifvisible.setIdleDuration(t)},setCurrentPageName:function(e){TimeMe.currentPageName=e},resetRecordedPageTime:function(e){TimeMe.startStopTimes[e]=[]},resetAllRecordedPageTimes:function(){for(var e=Object.keys(TimeMe.startStopTimes),t=0;t<e.length;t++)TimeMe.resetRecordedPageTime(e[t])},initialize:function(){TimeMe.startTimer()}},ifvisible.on("blur",function(){TimeMe.stopTimer()}),ifvisible.on("focus",function(){TimeMe.startTimer()}),ifvisible.on("idle",function(){TimeMe.stopTimer()}),ifvisible.on("wakeup",function(){TimeMe.startTimer()}),"function"==typeof define&&define.amd?define(function(){return TimeMe}):window.TimeMe=TimeMe;
!function(i,o,r,e,t,n,a,u){"use strict";function c(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function p(e,t,n){return t&&f(e.prototype,t),n&&f(e,n),e}var m={id:"",params:{},version:1},d=function(){function t(){l(this,t)}return p(t,null,[{key:"isPresent",value:function(e){return null!=e&&""!==e}},{key:"now",value:function(){return 1*new Date}},{key:"guid",value:function(){return m.version+"-xxxxxxxx-".replace(/[x]/g,function(e){var t=36*Math.random()|0;return("x"==e?t:3&t|8).toString(36)})+(1*new Date).toString(36)}},{key:"optionalData",value:function(e){return!1===t.isPresent(e)?"":"object"===s(e)?t.optionalData(JSON.stringify(e)):"function"==typeof e?t.optionalData(e()):String(e)}}]),t}(),h=function(){function e(){l(this,e)}return p(e,null,[{key:"nameAndVersion",value:function(){var e,t=navigator.userAgent,n=t.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(n[1])?"IE "+((e=/\brv[ :]+(\d+)/g.exec(t)||[])[1]||""):"Chrome"===n[1]&&null!=(e=t.match(/\b(OPR|Edge)\/(\d+)/))?e.slice(1).join(" ").replace("OPR","Opera"):(n=n[2]?[n[1],n[2]]:[navigator.appName,navigator.appVersion,"-?"],null!=(e=t.match(/version\/(\d+)/i))&&n.splice(1,1,e[1]),n.join(" "))}},{key:"isMobile",value:function(){return"ontouchstart"in o}},{key:"userAgent",value:function(){return i.navigator.userAgent}}]),e}(),g={getParameterByName:function(e,t){t||(t=i.location.href),e=e.replace(/[\[\]]/g,"\\$&");var n=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)","i").exec(t);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null},externalHost:function(e){return e.hostname!=location.hostname&&0===e.protocol.indexOf("http")}};var v=function(){function r(e,t,n){l(this,r),this.params=[],this.event=e,this.timestamp=t,this.optional=d.optionalData(n),this.buildParams(),this.send()}return p(r,[{key:"buildParams",value:function(){var e=this.getAttribute();for(var t in e)e.hasOwnProperty(t)&&this.setParam(t,e[t](t))}},{key:"getAttribute",value:function(){var t=this;return function(i){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?c(Object(o),!0).forEach(function(e){var t,n,r;t=i,r=o[n=e],n in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(o)):c(Object(o)).forEach(function(e){Object.defineProperty(i,e,Object.getOwnPropertyDescriptor(o,e))})}return i}({id:function(){return m.id},ev:function(){return t.event},ed:function(){return t.optional},v:function(){return m.version},dl:function(){return i.location.href},rl:function(){return o.referrer},ts:function(){return t.timestamp},de:function(){return o.characterSet},sr:function(){return i.screen.width+"x"+i.screen.height},vp:function(){return i.innerWidth+"x"+i.innerHeight},cd:function(){return i.screen.colorDepth},dt:function(){return o.title},bn:function(){return h.nameAndVersion()},md:function(){return h.isMobile()},ua:function(){return h.userAgent()},tz:function(){return(new Date).getTimezoneOffset()},path:function(){return i.location.pathname},url:function(){return i.location.protocol+"//"+i.location.hostname+i.location.pathname},hostname:function(){return i.location.hostname},timezone:function(){return Intl.DateTimeFormat().resolvedOptions().timeZone},width:function(){return i.innerWidth},clicked:function(){return(e=t.event)&&"click"==e?1:0;var e},converted:function(){return(e=t.event)&&"conversion"==e?1:0;var e},leaves:function(){return(e=t.event)&&"pageclose"==e?1:0;var e},time:function(){return TimeMe.getTimeOnCurrentPageInSeconds()}},m.params)}},{key:"setParam",value:function(e,t){d.isPresent(t)?this.params.push("".concat(e,"=").concat(encodeURIComponent(t))):this.params.push("".concat(e,"="))}},{key:"send",value:function(){i.navigator.sendBeacon?this.sendBeacon():this.sendImage()}},{key:"sendBeacon",value:function(){i.navigator.sendBeacon(this.getSourceUrl())}},{key:"sendImage",value:function(){this.img=o.createElement("img"),this.img.src=this.getSourceUrl(),this.img.style.display="none",this.img.width="1",this.img.height="1",o.getElementsByTagName("body")[0].appendChild(this.img)}},{key:"getSourceUrl",value:function(){return"".concat("https://pixtu-api.herokuapp.com/pixel.gif","?").concat(this.params.join("&"))}}]),r}();r.process=function(e,t,n){"init"===e?m.id=t:"param"===e?m.params[t]=function(){return n}:"event"===e&&("pageload"!==t||m.pageLoadOnce?"pageload"!==t&&"pageclose"!==t&&new v(t,d.now(),n):(m.pageLoadOnce=!0,new v(t,r.t,n)))};for(var y=0,b=r.queue.length;y<b;y++)r.process.apply(r,r.queue[y]);i.addEventListener("unload",function(){m.pageCloseOnce||(m.pageCloseOnce=!0,new v("pageclose",d.now(),function(){if(d.isPresent(m.externalHost)&&d.now()-m.externalHost.time<5e3)return m.externalHost.link}))}),i.onload=function(){TimeMe.initialize({currentPageName:"pixtu",idleTimeoutInSeconds:30});for(var e=o.getElementsByTagName("a"),t=0,n=e.length;t<n;t++)e[t].addEventListener("click",function(e){pixtu("event","click",{time:TimeMe.getTimeOnCurrentPageInSeconds()}),g.externalHost(this)&&(m.externalHost={link:this.href,time:d.now()})}.bind(e[t]));var r=o.querySelectorAll("[data-pixtu-event]");for(t=0,n=r.length;t<n;t++)r[t].addEventListener("click",function(e){var t=this.getAttribute("data-pixtu-event");t&&new v(t,d.now(),this.getAttribute("data-pixtu-data"))}.bind(r[t]))}}(window,document,window.pixtu);